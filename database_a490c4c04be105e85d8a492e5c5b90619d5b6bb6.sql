CREATE TABLE articles (id INT AUTO_INCREMENT NOT NULL, place_id INT DEFAULT NULL, sub_family_id INT DEFAULT NULL, code VARCHAR(15) DEFAULT NULL, description VARCHAR(255) NOT NULL, state INT NOT NULL, quantity INT NOT NULL, INDEX IDX_BFDD3168DA6A219 (place_id), INDEX IDX_BFDD3168D15310D4 (sub_family_id), PRIMARY KEY(id)) ENGINE = InnoDB;
CREATE TABLE articles_loans (loan_id INT NOT NULL, article_id INT NOT NULL, quantity INT NOT NULL, date_start DATE NOT NULL, date_end DATE NOT NULL, INDEX IDX_6A2065487294869C (article_id), INDEX IDX_6A206548CE73868F (loan_id), PRIMARY KEY(loan_id, article_id)) ENGINE = InnoDB;
CREATE TABLE families (id INT AUTO_INCREMENT NOT NULL, name VARCHAR(50) NOT NULL, PRIMARY KEY(id)) ENGINE = InnoDB;
CREATE TABLE loans (id INT AUTO_INCREMENT NOT NULL, user_id INT DEFAULT NULL, reason LONGTEXT NOT NULL, date_start DATE NOT NULL, date_end DATE NOT NULL, INDEX IDX_82C24DBCA76ED395 (user_id), PRIMARY KEY(id)) ENGINE = InnoDB;
CREATE TABLE places (id INT AUTO_INCREMENT NOT NULL, name VARCHAR(50) NOT NULL, PRIMARY KEY(id)) ENGINE = InnoDB;
CREATE TABLE structures (id INT AUTO_INCREMENT NOT NULL, name VARCHAR(255) NOT NULL, PRIMARY KEY(id)) ENGINE = InnoDB;
CREATE TABLE sub_families (id INT AUTO_INCREMENT NOT NULL, family_id INT DEFAULT NULL, name VARCHAR(50) NOT NULL, INDEX IDX_23F0D195C35E566A (family_id), PRIMARY KEY(id)) ENGINE = InnoDB;
CREATE TABLE sub_family_fields (id INT AUTO_INCREMENT NOT NULL, sub_family_id INT DEFAULT NULL, name VARCHAR(50) NOT NULL, INDEX IDX_78787343D15310D4 (sub_family_id), PRIMARY KEY(id)) ENGINE = InnoDB;
CREATE TABLE sub_family_fields_values (sub_family_field_id INT NOT NULL, article_id INT NOT NULL, value VARCHAR(255) DEFAULT NULL, INDEX IDX_5CE898939C369CEC (sub_family_field_id), INDEX IDX_5CE898937294869C (article_id), PRIMARY KEY(sub_family_field_id, article_id)) ENGINE = InnoDB;
CREATE TABLE users (id INT AUTO_INCREMENT NOT NULL, structure_id INT DEFAULT NULL, username VARCHAR(50) NOT NULL, password VARCHAR(255) NOT NULL, salt VARCHAR(255) NOT NULL, firstName VARCHAR(50) DEFAULT NULL, lastName VARCHAR(50) DEFAULT NULL, telephone VARCHAR(25) DEFAULT NULL, function VARCHAR(50) DEFAULT NULL, address LONGTEXT DEFAULT NULL, type INT NOT NULL, INDEX IDX_1483A5E92534008B (structure_id), PRIMARY KEY(id)) ENGINE = InnoDB;
ALTER TABLE articles ADD FOREIGN KEY (place_id) REFERENCES places(id) ON DELETE SET NULL;
ALTER TABLE articles ADD FOREIGN KEY (sub_family_id) REFERENCES sub_families(id) ON DELETE SET NULL;
ALTER TABLE articles_loans ADD FOREIGN KEY (article_id) REFERENCES articles(id) ON DELETE CASCADE;
ALTER TABLE articles_loans ADD FOREIGN KEY (loan_id) REFERENCES loans(id) ON DELETE CASCADE;
ALTER TABLE loans ADD FOREIGN KEY (user_id) REFERENCES users(id);
ALTER TABLE sub_families ADD FOREIGN KEY (family_id) REFERENCES families(id) ON DELETE CASCADE;
ALTER TABLE sub_family_fields ADD FOREIGN KEY (sub_family_id) REFERENCES sub_families(id) ON DELETE CASCADE;
ALTER TABLE sub_family_fields_values ADD FOREIGN KEY (sub_family_field_id) REFERENCES sub_family_fields(id) ON DELETE CASCADE;
ALTER TABLE sub_family_fields_values ADD FOREIGN KEY (article_id) REFERENCES articles(id) ON DELETE CASCADE;
ALTER TABLE users ADD FOREIGN KEY (structure_id) REFERENCES structures(id);